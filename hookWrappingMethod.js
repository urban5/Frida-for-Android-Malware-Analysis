//SHA256 of the sample, following script was used on: 2c05efa757744cb01346fe6b39e9ef8ea2582d27481a441eb885c5c4dcd2b65b
//Detailed unpacking of the sample available in another article written by Cryptax: https://cryptax.medium.com/inside-kangapack-the-kangaroo-packer-with-native-decryption-3e7e054679c4

Java.perform(function () {
    // Define the target class and method
    var targetClass = "com.hwgapkspv.gouhwkh.XBFkfYNbujfaaLbgYxmf";
    var targetMethod = "bhwi8sma09d23ssva";

    // Get a reference to the target class
    var TargetClass = Java.use(targetClass);

    // Hook the method implementation, change parameter types appropriately for other samples
    TargetClass[targetMethod].overload('java.io.File', 'java.lang.String').implementation = function (file, name) {
        console.log(" === Hooked " + targetMethod);
        console.log("Argument 1 (file): " + file.getPath());
        console.log("Argument 2 (name): " + name);

        // Call the original method
        var returnValue = this[targetMethod](file, name);

        // Output the return value
        console.log("Return value: " + returnValue.getPath());

        // Return the original method's return value
        return returnValue;
    };

    console.log("Hooked " + targetClass + "." + targetMethod);
});
